# QUTMS_VCU

This repo contains the firmware developed for QUT Motorsport's Vehicle Control Unit (VCU). This was a multi-purpose board, able to act as the key vehicle controller, whilst also as a generic sensor board, digitializing analogue sensor outputs and broadcasting them over CAN, and also able to switch 12V loads.

The VCU utilized a STM32F207 based microcontroller.

## Contents

This repository contains three main STM32 projects:

- software_v3: RTOS based rewrite of the firmware, latest version of the code, ran on QEV3 and QEV4 in 2023.
- software: Original non-RTOS based firmware project, run on QEV3 in 2022.
- TestFirmware: Project containing firmware to test actuation of VCU hardware.

## Project Structure

Each directory as above contains a project suitable for opening with STM32CubeIDE. The recommended method for viewing the projects as a whole would be to open the specific directory in STM32CubeIDE.

Each project contains 3 main code directories, `Common`, `Core`, and `Firmware`.

- `Common` - The copy/version of QUTMS_Embedded_Common (https://github.com/QUT-Motorsport/QUTMS_Embedded_Common/) utilized in the project. This mainly contains definitions for all CAN messages, including IDs, message composer and parser functions, but also contains other assorted common code shared across QUTMS firmware projects.
- `Core` - This directory contains autogenerated code from STM32CubeMX, based on the preconfigured IOC file per project, including peripheral and driver initialization. Individual periperhal files also contain specific custom code relevant to actuating the peripheral. The key starting file here is `main.c`, as it contains the project's main loop.
- `Firmware` - The bulk of the application specific code for the project. Hardware drivers, sensor firmware, and key state machine implementations are here.
